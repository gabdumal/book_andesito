---
title: Configurando o Visual Studio Code
author: Gabriel Malosto
---

import { Aside } from "@astrojs/starlight/components";

import Figure from "/src/components/Figure.astro";
import Keyboard from "/src/components/Keyboard.astro";

import openingProfiles from "/src/assets/common/opening_profiles.png";
import createProfile from "/src/assets/content/docs/c_cpp/compiler/vscode/create_profile.png";
import selectProfile from "/src/assets/content/docs/c_cpp/compiler/vscode/select_profile.png";
import searchSnippets from "/src/assets/content/docs/c_cpp/compiler/vscode/search_snippets.png";
import newSnippetsFile from "/src/assets/content/docs/c_cpp/compiler/vscode/new_snippets_file.png";
import globalSnippets from "/src/assets/content/docs/c_cpp/compiler/vscode/global_snippets.png";
import defaultSnippetsFile from "/src/assets/content/docs/c_cpp/compiler/vscode/default_snippets_file.png";
import useSnippet from "/src/assets/content/docs/c_cpp/compiler/vscode/use_snippet.png";
import usedSnippet from "/src/assets/content/docs/c_cpp/compiler/vscode/used_snippet.png";
import compileRunLinked from "/src/assets/content/docs/c_cpp/compiler/vscode/compile_run_linked.png";

Para compilar e executar programas em C no Visual Studio Code, devemos instalar algumas extensões.
Recomendamos criar um perfil para o C e C++, o que manterá as configurações para essas linguagens separadas.

## Perfil

Para criar um perfil no Visual Studio Code, clique no ícone de engrenagem no canto inferior esquerdo e selecione **Profiles** (ou perfis).

<Figure
  caption={`Abrindo a tela de configuração de perfis do Visual Studio Code.`}
  images={[
    {
      src: openingProfiles,
      alt: `Menu de configuração do Visual Studio Code, em que se seleciona a opção "Profiles".`,
    },
  ]}
/>

Clique no botão **New Profile**.
Uma nova entrada surgirá na lista de perfis.

Dê um nome ao perfil, como `C/C++`.
Escolha o ícone de sua preferências.

<Figure
  caption={`Criando um novo perfil chamado "C/C++".`}
  images={[
    {
      src: createProfile,
      alt: `Tela de criação de perfil do Visual Studio Code, em que se preenche o nome "C/C++" e se escolhe um ícone.`,
    },
  ]}
/>

Agora, selecione o perfil ao clicar no ícone de check ao lado da entrada dele na lista de perfis.

<Figure
  caption={`Selecionando o perfil "C/C++".`}
  images={[
    {
      src: selectProfile,
      alt: `Menu de perfis do Visual Studio Code, em que se seleciona o perfil "C/C++".`,
    },
  ]}
/>

## Extensões

Tendo ativado o perfil `C/C++`, instale as seguinte extensões no Visual Studio Code:

- [Git Graph](https://marketplace.visualstudio.com/items?itemName=mhutchie.git-graph): visualiza o histórico de commits do Git;
- [C/C++](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools): fornece suporte para desenvolvimento em C e C++;
- [clangd](https://marketplace.visualstudio.com/items?itemName=llvm-vs-code-extensions.vscode-clangd): fornece recursos de análise de código para o Clang;
- [CodeLLDB](https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb): permite a depuração de programas em C e C++.

Se você estiver usando o WSL, certifique-se de clicar nos botões **Install in WSL: Ubuntu** para cada extensão da lista de instaladas que oferecer essa opção.

## Configurações

Vamos adicionar algumas configurações padrão para o perfil `C/C++`.

Abra a paleta de comandos do Visual Studio Code com <Keyboard keys={["Ctrl", "Shift", "P"]} /> e pesquise por `Preferences: Open User
Settings (JSON)`, ou o equivalente em português.

Isso abrirá um arquivo chamado `settings.json`, responsável por definir as configurações desse perfil.
Toda vez que você muda alguma opção no menu de configurações do Visual Studio Code, o que ele faz é adicionar ou modificar uma linha nesse arquivo por baixo dos panos.

Copie o conteúdo a seguir e cole no arquivo `settings.json` aberto.

```json
{
  "C_Cpp.default.cStandard": "c23",
  "C_Cpp.default.cppStandard": "c++23",
  "C_Cpp.default.includePath": ["${workspaceFolder}/**"],
  "C_Cpp.default.intelliSenseMode": "clang-x64",
  "C_Cpp.intelliSenseEngine": "disabled",
  "[css]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[html]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[javascript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[json]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode",
    "editor.tabSize": 2
  },
  "[jsonc]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode",
    "editor.tabSize": 2
  },
  "[markdown]": {
    "editor.defaultFormatter": "DavidAnson.vscode-markdownlint",
    "editor.formatOnPaste": true,
    "editor.formatOnSave": true,
    "editor.tabSize": 2,
    "prettier.tabWidth": 2
  },
  "editor.formatOnSave": true,
  "editor.inlineSuggest.enabled": true,
  "editor.semanticHighlighting.enabled": true,
  "files.eol": "\n",
  "files.insertFinalNewline": true,
  "files.trimFinalNewlines": true,
  "git.autofetch": true,
  "git.openRepositoryInParentFolders": "always",
  "security.allowedUNCHosts": ["wsl$", "wsl.localhost"]
}
```

Perceba que, abrindo o arquivo `settings.json` quando se usa o perfil `C/C++`, você verá as configurações específicas para este perfil, e não as configurações gerais do Visual Studio Code.
É este mesmo o objetivo que temos.

A configuração definida no arquivo `settings.json` faz o seguinte:

- O compilador Clang é definido como o compilador padrão;
- Ativamos o IntelliSense para o Clang;
- As versões do C e do C++ são definidas como C23 e C++23, respectivamente;
- Definimos o formatador padrão como a extensão `clangd`, e desativamos a formatação da extensão `C/C++`;
- Entre outras definições úteis.

Salve o arquivo e feche o Visual Studio Code.

<Aside type="tip">
  Caso você venha a precisar compilar um projeto para uma versão mais velha que
  a 23, basta alterar o valor das chaves `C_Cpp.default.cStandard` e
  `C_Cpp.default.cppStandard` para a versão desejada.
</Aside>

## Snippets

Snippets são trechos de código que podem ser inseridos rapidamente no editor.
Eles possuem um atalho que, ao ser digitado e pressionado <Keyboard keys={["Tab"]} />, expande o trecho para o código completo.

Estamos utilizando o `clang-format` como formatador de texto e o `clang-tidy` como linter.
Para configurá-los, basta criar um arquivo `.clang-format` e um `.clang-tidy` na raiz do projeto.

Entretanto, criar e configurar esses arquivos manualmente pode ser trabalhoso.
Por isso, podemos utilizar um snippet para criar esses arquivos automaticamente.

Garanta que você tenha selecionado o perfil `C/C++`.
Então abra a paleta de comandos do Visual Studio Code com <Keyboard keys={["Ctrl", "Shift", "P"]} /> e pesquise por `Snippets: Configure Snippets`.

<Figure
  caption={`Abrindo a configuração de snippets do Visual Studio Code.`}
  images={[
    {
      src: searchSnippets,
      alt: `Menu de comandos do Visual Studio Code, em que se pesquisa por "Snippets: Configure Snippets".`,
    },
  ]}
/>

Selecione a opção `New Global Snippets file`.

<Figure
  caption={`Criando um novo arquivo de snippets.`}
  images={[
    {
      src: newSnippetsFile,
      alt: `Menu de comandos do Visual Studio Code, em que se seleciona a opção "New Global Snippets file".`,
    },
  ]}
/>

Digite o nome `global` e pressione <Keyboard keys={["Enter"]} />.

<Figure
  caption={`Nomeando o arquivo de snippets como "global".`}
  images={[
    {
      src: globalSnippets,
      alt: `Campo de texto para nomear o arquivo de snippets, com o nome "global" preenchido.`,
    },
  ]}
/>

O arquivo de configuração de snippets para o perfil `C/C++` será aberto.
Seu nome é `global.code-snippets`.
Este é o conteúdo padrão dele:

<Figure
  caption={`Conteúdo padrão do arquivo de snippets "global".`}
  images={[
    {
      src: defaultSnippetsFile,
      alt: `Arquivo de snippets "global" com o conteúdo padrão, que ensina a definir um snippet.`,
    },
  ]}
/>

Apague todo o conteúdo dele.
Em seguida, copie o conteúdo abaixo e cole no arquivo.

```json
{
  "Clang Format configuration": {
    "prefix": "clang-format",
    "body": [
      "AccessModifierOffset: -4",
      "# AlignAfterOpenBracket: BlockIndent",
      "BasedOnStyle: Google",
      "BracedInitializerIndentWidth: 4",
      "ColumnLimit: 0",
      "ContinuationIndentWidth: 4",
      "EmptyLineAfterAccessModifier: Never",
      "EmptyLineBeforeAccessModifier: LogicalBlock",
      "FixNamespaceComments: true",
      "IndentAccessModifiers: true",
      "IndentCaseBlocks: true",
      "IndentCaseLabels: true",
      "IndentExternBlock: true",
      "IndentGotoLabels: true",
      "IndentPPDirectives: AfterHash",
      "IndentRequiresClause: true",
      "IndentWidth: 4",
      "InsertBraces: true",
      "IndentWrappedFunctionNames: true",
      "InsertNewlineAtEOF: true",
      "NamespaceIndentation: All",
      "ObjCBlockIndentWidth: 4",
      "PointerAlignment: Right",
      "PPIndentWidth: 4",
      "SeparateDefinitionBlocks: Always",
      "SpaceAfterCStyleCast: true",
      "SpaceAfterLogicalNot: false",
      "SpaceAfterTemplateKeyword: false",
      "SpaceBeforeAssignmentOperators: true",
      "SpaceBeforeCtorInitializerColon: false",
      "SpaceBeforeInheritanceColon: false",
      "SpaceBeforeParens: ControlStatements",
      "Standard: Latest",
      "TabWidth: 4",
      "UseTab: Never",
      ""
    ],
    "description": "Clang Format configuration"
  },
  "Clang Tidy configuration": {
    "prefix": "clang-tidy",
    "body": [
      "Checks: \"-*,readability-identifier-naming\"",
      "CheckOptions:",
      "  # Macro",
      "  - key: readability-identifier-naming.MacroDefinitionCase",
      "    value: UPPER_CASE",
      "  - key: readability-identifier-naming.MacroDefinitionPrefix",
      "    value: \"_\"",
      "  - key: readability-identifier-naming.MacroDefinitionIgnoredRegexp",
      "    value: \"^[A-Z]+(_[A-Z]+)*_$\"",
      "",
      "  # Default",
      "  - key: readability-identifier-naming.VariableCase",
      "    value: lower_case",
      "",
      "  - key: readability-identifier-naming.StaticVariableCase",
      "    value: lower_case",
      "",
      "  - key: readability-identifier-naming.ParameterCase",
      "    value: lower_case",
      "",
      "  - key: readability-identifier-naming.FunctionCase",
      "    value: camelBack",
      "",
      "  - key: readability-identifier-naming.TypeAliasCase",
      "    value: CamelCase",
      "",
      "  - key: readability-identifier-naming.TypedefCase",
      "    value: CamelCase",
      "",
      "  - key: readability-identifier-naming.ConstantCase",
      "    value: UPPER_CASE",
      "",
      "  - key: readability-identifier-naming.StaticConstantCase",
      "    value: lower_case",
      "",
      "  - key: readability-identifier-naming.ConstexprVariableCase # Ensure the constexpr variables are treated as constants",
      "    value: lower_case",
      "  - key: readability-identifier-naming.ConstexprVariablePrefix",
      "    value: \"\"",
      "",
      "  # Class",
      "  - key: readability-identifier-naming.ClassCase",
      "    value: CamelCase",
      "",
      "  - key: readability-identifier-naming.MemberCase",
      "    value: lower_case",
      "",
      "  # Enum",
      "  - key: readability-identifier-naming.EnumCase",
      "    value: CamelCase",
      "",
      "  - key: readability-identifier-naming.EnumConstantCase",
      "    value: UPPER_CASE",
      "",
      "  # Struct",
      "  - key: readability-identifier-naming.StructMemberCase",
      "    value: lower_case",
      "",
      "  # Namespace",
      "  - key: readability-identifier-naming.NamespaceCase",
      "    value: CamelCase",
      "",
      "  - key: readability-identifier-naming.NamespaceConstantCase",
      "    value: lower_case",
      "",
      "  - key: readability-identifier-naming.ClassMemberCase",
      "    value: lower_case",
      "",
      "  # Global",
      "  - key: readability-identifier-naming.GlobalConstantCase",
      "    value: UPPER_CASE",
      ""
    ],
    "description": "Clang Tidy configuration"
  }
}
```

Lembre-se de salvar o arquivo `global.code-snippets`.

Para usar os snippets, feche e abra o Visual Studio Code.

Então, abra o diretório `separate_function` que criamos anteriormente.
Crie um arquivo chamado `.clang-format` e outro chamado `.clang-tidy` na raiz do projeto.

Em seguida, abra o arquivo `.clang-format`, digite `clang-format` e pressione <Keyboard keys={["Enter"]} />.

<Figure
  caption={`Utilizando o snippet "clang-format".`}
  images={[
    {
      src: useSnippet,
      alt: `Arquivo ".clang-format" vazio, em que se digita "clang-format". O Visual Studio Code sugere completar com o snippet "Clang Format configuration".`,
    },
  ]}
/>

O arquivo `.clang-format` será preenchido com as configurações definidas no snippet `Clang Format configurations`.

<Figure
  caption={`Arquivo ".clang-format" preenchido com as configurações do snippet.`}
  images={[
    {
      src: usedSnippet,
      alt: `Arquivo ".clang-format" preenchido com as configurações do snippet "Clang Format configuration".`,
    },
  ]}
/>

Agora, faça o mesmo para o arquivo `.clang-tidy`.

<Aside type="tip">
  Caso deseje alterar as configurações do arquivo `.clang-format`, basta
  editá-lo. O LLVM disponibiliza a
  [documentação](https://clang.llvm.org/docs/ClangFormatStyleOptions.html)
  acerca das opções de formatação. Igualmente, está disponível a
  [documentação](https://clang.llvm.org/extra/clang-tidy/) do Clang Tidy.
</Aside>

## Projeto

Vamos criar um projeto para construir uma lista encadeada de nós.

No terminal, navegue para a pasta `c_cpp_projects` que criamos anteriormente.

```bash
cd ~/dev/c_cpp_projects
```

Crie um diretório chamado `linked_nodes` e navegue para dentro dele.

```bash
mkdir linked_nodes
cd linked_nodes
```

Abra o Visual Studio Code no diretório atual.

```bash
code .
```

Selecione o **perfil `C/C++`** que criamos anteriormente.

### Arquivos

Crie um arquivo chamado `node.h` e cole o seguinte código nele.

```c
#ifndef __NODE_H__
#define __NODE_H__

struct Node {
        int data;
        struct Node *next;
};

struct Node *createNode();
void setData(struct Node *node, int data);
int getData(struct Node *node);
void setNext(struct Node *node, struct Node *next);
struct Node *getNext(struct Node *node);

#endif  // __NODE_H__
```

Então, crie um arquivo chamado `node.c` e cole o código a seguir.

```c
#include "node.h"

#include <stdio.h>
#include <stdlib.h>

struct Node *createNode() {
    struct Node *new_node = (struct Node *) malloc(sizeof(struct Node));
    if (new_node != NULL) {
        new_node->data = 0;
        new_node->next = NULL;
    }
    return new_node;
}

void setData(struct Node *node, int data) {
    if (node != NULL) {
        node->data = data;
    }
}

int getData(struct Node *node) {
    if (node != NULL) {
        return node->data;
    }
    return -1;
}

void setNext(struct Node *node, struct Node *next) {
    if (node != NULL) {
        node->next = next;
    }
}

struct Node *getNext(struct Node *node) {
    if (node != NULL) {
        return node->next;
    }
    return NULL;
}
```

Por fim, crie um arquivo chamado `main.` e cole o código a seguir.

```c
#include <stdio.h>
#include <stdlib.h>

#include "node.h"

int main() {
    printf("Creating a linked list with 10 nodes\n");

    struct Node *node = createNode();
    struct Node *head = node;
    setData(node, 1);

    for (int i = 2; i <= 10; i++) {
        struct Node *new_node = createNode();
        setData(new_node, i);
        setNext(node, new_node);
        node = new_node;
    }

    printf("Traversing the linked list\n");

    node = head;

    while (node != NULL) {
        printf("%d\t", getData(node));
        node = getNext(node);
    }

    printf("\n");

    return 0;
}
```

{/* TODO: Fix link */}

Você também pode acessar esse projeto no [repositório do livro](https://github.com/gabdumal/book_andesito/tree/main/public).

Para configurar a formatação e o linter, crie os arquivos `.clang-format` e `.clang-tidy` na raiz do projeto.
Então utilize os snippets `clang-format` e `clang-tidy` para preenchê-los.

### Compilação

Você verá que o Visual Studio Code já reconhece o projeto e identifica as bibliotecas e funções utilizadas.

Vamos compilar o projeto pelo terminal integrado do Visual Studio Code.
Abra o terminal integrado com <Keyboard keys={["Ctrl", "`"]} /> e execute o comando abaixo.

```bash
clang main.c node.c -include node.h -o linked_nodes
```

Esse comando compila os arquivos `main.c` e `node.c`, incluindo o arquivo de cabeçalho `node.h`, e gera o arquivo executável `linked_nodes`. Para executar o programa, digite `./linked_nodes` e pressione <Keyboard keys={["Enter"]} />.

<Figure
  caption={`Compilação e execução do projeto "linked_nodes".`}
  images={[
    {
      src: compileRunLinked,
      alt: `Terminal integrado do Visual Studio Code exibindo a compilação e execução do projeto "linked_nodes".`,
    },
  ]}
/>
